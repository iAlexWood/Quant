# 异质自回归（HAR）模型：金融波动率预测的理论、扩展与应用综合评述

## 1\. 波动率建模导论及HAR框架的起源

### 1.1 波动率在金融中的核心作用

在现代金融理论与实践中，波动率（Volatility）扮演着至关重要的角色。它不仅是衡量资产价格在一定时期内分散程度的统计指标，更是量化不确定性和风险的核心工具 。波动率的精确估计与预测是资产定价、投资组合优化、衍生品定价以及风险管理等多个金融领域基石般的存在 。在资产定价模型中，波动率是决定资产风险溢价的关键因素；在投资组合管理中，对波动率和风险的估算构成了优化资产配置的基础，因为它直接关系到回报率的分散程度 ；在期权等衍生品定价领域，波动率是布莱克-斯科尔斯（Black-Scholes）模型等经典定价公式中的一个不可或缺的参数 ；而在风险管理实践中，波动率预测是计算风险价值（Value-at-Risk, VaR）和预期亏损（Expected Shortfall, ES）等关键风险度量指标的前提，对于金融机构满足监管要求、设定资本充足率至关重要。因此，金融经济学文献对波动率建模的研究投入了巨大的精力，旨在开发出能够准确捕捉其动态特征的模型。  

### 1.2 金融波动率的典型化事实

金融资产回报率的波动率呈现出一系列独特的、被广泛验证的经验性规律，这些“典型化事实”（Stylized Facts）对任何有效的波动率模型都构成了严峻的挑战。这些特征主要包括：

1.  **波动率聚集性（Volatility Clustering）**：波动率在时间序列上表现出明显的聚集现象，即高波动率时期之后往往是高波动率时期，而低波动率时期之后则倾向于持续低波动率。这种现象反映在回报率序列上，表现为“大波动的聚集”和“小波动的聚集” 。  
    
2.  **持续性与长记忆性（Persistence and Long Memory）**：金融波动率表现出高度的持续性，其自相关函数（Autocorrelation Function, ACF）的衰减速度非常缓慢，呈现出双曲线衰减（hyperbolic decay）的特征，而非标准自回归模型所暗示的指数衰减（exponential decay） 。这种缓慢衰减的自相关性通常被称为“长记忆性”（Long Memory），意味着过去的波动率冲击对未来波动率的影响会持续很长一段时间，甚至数月之久 。传统的潜在波动率模型，如标准的GARCH模型，往往难以充分描述这种自相关性缓慢下降的特征 。  
    
3.  **对市场信息的非线性响应**：波动率对市场信息的反应是非线性的。其中最著名的现象是“杠杆效应”（Leverage Effect），即负面消息（价格下跌）对未来波动率的推升作用通常大于同等幅度的正面消息（价格上涨） 。此外，市场对不同类型信息的反应也存在差异，这导致了波动率动态的复杂性。  
    

这些典型化事实表明，波动率是一个复杂的动态过程，简单的线性或短记忆模型无法充分捕捉其内在规律。长记忆性尤其成为波动率建模领域的一个核心难题，催生了诸如分数阶积分自回归移动平均（ARFIMA）和分数阶积分GARCH（FIGARCH）等模型的出现。然而，这些模型的复杂性也促使研究者寻求更简洁、更具经济直觉的替代方案。

### 1.3 异质市场假说（HMH）的经济学基础

异质自回归（HAR）模型的理论根基并非源于纯粹的统计拟合，而是深植于一个重要的经济学理论——异质市场假说（Heterogeneous Market Hypothesis, HMH）。该假说最早由Müller等人于1993年提出，它挑战了传统金融模型中关于市场参与者同质性的假设，认为金融市场是由具有不同特征的参与者群体构成的 。  

HMH的核心观点是，市场参与者在诸多方面存在异质性，尤其是在他们的投资时间视界（investment time horizons）上 。市场可以被划分为不同类型的交易者：  

-   **短期交易者**：如高频交易者、投机者和做市商，他们的交易频率非常高，关注日内甚至更高频率的价格变动。
    
-   **中期交易者**：他们的交易周期可能以周为单位，关注市场的中期趋势。
    
-   **长期投资者**：如养老基金、保险公司和中央银行等机构投资者，他们的交易频率较低，持仓周期可能长达数月甚至数年，更关注市场的长期基本面和风险 。  
    

由于投资视界的不同，这些异质的参与者对同一市场信息的解读和反应方式也截然不同，从而导致并感知到不同时间尺度上的波动率成分 。短期交易者的频繁交易行为主要产生短期波动，而长期投资者的决策则更多地影响市场的长期趋势和风险水平。  

基于这一观察，HMH进一步提出了一个关键的机制，即“累加波动率瀑布”（additive volatility cascade） 。该机制认为，不同时间尺度上的波动率成分之间存在一种不对称的影响关系：长期波动率对短期波动率的影响，要强于短期波动率对长期波动率的影响 。其经济学解释在于，对于短期交易者而言，长期的波动率水平决定了未来市场趋势的潜在规模和整体风险环境，因此是他们制定交易策略时必须考虑的重要背景因素 。这种从长周期到短周期的信息传导和影响，形成了一个如同瀑布般逐级累加的结构。正是这种累加波动率瀑布的理念，直接启发了HAR模型的构建，使其 regressors（回归因子）并非出于统计便利，而是先验地设定为代表不同交易者群体的波动率成分。因此，HAR模型从根本上说，是一个以简洁统计形式呈现的经济学模型。它的成功不仅在于预测的准确性，更在于为HMH这一经济理论提供了强有力的实证支持。  

### 1.4 范式转换：从潜在波动率到已实现波动率（RV）

HAR模型的诞生和成功，离不开金融计量领域的一次重大范式转换：从对不可观测的“潜在波动率”（latent volatility）进行建模，转向对可直接度量的“已实现波动率”（Realized Volatility, RV）进行建模。

在数十年间，波动率建模领域一直由GARCH（广义自回归条件异方差）及其衍生模型主导。GARCH框架将波动率视为一个潜在变量，无法直接观测，只能通过基于低频日度回报率数据的复杂滤波方法（如准最大似然估计）来间接推断 。这种方法虽然在理论上卓有建树，但在实践中面临一个根本性问题：日度平方回报率是真实波动率的一个充满噪声的代理变量，这极大地限制了模型的样本外预测能力 。  

随着高频金融数据的普及，Andersen等人提出了一种全新的波动率度量方法，即已实现波动率（RV）。RV的定义非常直观，它是通过加总一天内所有高频（如5分钟）区间的回报率平方来构建的 。从理论上讲，当采样频率趋于无穷大时，RV能够一致地估计该日度的积分方差（Integrated Variance），即真实波动率的理论对应物 。  

RV的出现彻底改变了波动率建模的游戏规则。它将波动率从一个需要复杂推断的“潜在”变量，转变为一个在很大程度上可以被“观测”到的变量（尽管仍存在微观结构噪声等度量误差） 。这一转变带来了方法论上的巨大简化。研究者的任务不再是对一个潜在变量进行滤波，而是对一个可观测的时间序列进行预测。这种转变使得应用简单、直观的线性回归模型成为可能，从而为HAR模型的诞生铺平了道路。可以说，HAR模型的简洁性和强大预测能力，是建立在RV这一更优越、信息含量更丰富的数据基础之上的。它通过解决一个更简单的问题（预测一个可观测序列）并使用更好的输入数据（RV），从而超越了在更嘈杂数据上解决更复杂问题（过滤一个潜在变量）的传统GARCH模型。  

## 2\. 经典的HAR-RV模型

### 2.1 数学公式与解读

由Fulvio Corsi于2009年正式提出的经典异质自回归已实现波动率模型（HAR-RV），是HMH经济直觉的最直接和最成功的数学表达 。该模型结构异常简洁，是一个简单的线性回归模型，旨在预测下一交易日的日度已实现波动率。其标准数学公式如下 ：  
```math
\widehat{RV}_{t+1}^{(d)}=β_0+β_dRV_t^{(d)}+β_wRV_t^{(w)}+β_mRV_t^{(m)}+ϵ_{t+1}
```
模型中各个组成部分的详细解释如下：

-   $\widehat{RV}_{t+1}^{(d)}$：表示在 $t$ 时刻对 $t+1$ 交易日的日度（daily）已实现波动率的预测值。
    
-   $RV_{t}^{(d)}$：表示 $t$ 交易日当天的已实现波动率。这个变量代表了由短期交易者行为驱动的短期波动率成分。
    
-   $RV_{t}^{(w)}$：表示在 $t$ 时刻计算的过去一周（weekly）的平均已实现波动率。它通常定义为过去5个交易日日度RV的算术平均值 ：  
    
    $\displaystyle RV_t^{(w)}=\frac{1}{5}∑_{i=1}^5​RV_{t−i+1}^{(d)}$
    
    这个变量代表了由中期交易者行为驱动的中期波动率成分。
    
-   $RV_{t}^{(m)}$：表示在 t 时刻计算的过去一个月（monthly）的平均已实现波动率。它通常定义为过去22个交易日（约等于一个交易月）日度RV的算术平均值 ：  
    
    $\displaystyle RV_t^{(m)}=\frac{1}{22}∑_{i=1}^{22}RV_{t−i+1}^{(d)}$
    
    这个变量代表了由长期投资者行为驱动的长期波动率成分。
    
-   $\beta_0, \beta_d, \beta_w, \beta_m$：是模型的待估参数，分别代表截距项以及日、周、月三个波动率成分对未来波动率的线性影响。
    
-   $\epsilon_{t+1}$：是模型的误差项，通常假设为白噪声。
    

HAR-RV模型的结构清晰地体现了前述的“累加波动率瀑布”思想 。它假设对未来一日波动率的预期，是过去不同时间视界（日、周、月）下已实现波动率的加权平均。每个回归系数（ $\beta_d, \beta_w, \beta_m$ ）的大小，反映了相应时间尺度上的交易者群体对市场未来波动的影响力。这种结构不仅在统计上有效，更重要的是它具有清晰的经济学解释，使得模型的分析和应用更具直观性。  

### 2.2 用简洁结构近似长记忆性

HAR模型最引人注目的特性之一，是它虽然在形式上是一个简单的短记忆自回归模型（其回归因子只依赖于有限的过去信息），但却能够极其成功地复制出金融波动率序列中典型的长记忆性特征，即自相关函数的双曲线衰减 。这使得HAR模型成为处理长记忆性问题的一个极具吸引力的替代方案，因为它避免了ARFIMA或FIGARCH等正式长记忆模型在估计和解释上的复杂性 。  

HAR模型实现这一“近似长记忆”效果的机制，并非依赖于复杂的数学构造，而是源于其多尺度成分的叠加。Corsi（2009）的核心洞见在于，金融市场中观测到的长记忆性可能并非源于一个单一的分数阶积分过程，而是一种“表观”现象（apparent behavior） 。这种表观长记忆性，可以通过将几个具有不同衰减速度（即不同持续性）的短记忆过程进行简单的线性叠加来生成。在HAR模型中，日度、周度和月度三个AR(1)类型的成分，各自代表了不同半衰期的波动冲击。当这三个成分叠加在一起时，它们共同产生的总体的自相关函数衰减模式，在有限的样本长度内，与真正的双曲线衰减模式在统计上几乎无法区分 。  

因此，HAR模型的创新之处在于其概念上的转变，而非数学上的复杂化。它通过一个经济学上合理且数学上易于处理的多成分框架，重新诠释并解决了长记忆性这一棘手问题。它证明了，在实际的预测应用中，一个精心设计的多尺度短记忆近似模型，其效果往往不亚于甚至优于一个理论上更精确但更难驾驭的真长记忆模型。这种方法论上的取舍，优先考虑了经济直觉和模型的可操作性，是HAR模型获得巨大成功的关键。

### 2.3 估计技术及其影响

HAR模型的巨大吸引力之一在于其估计的简便性。作为一个标准的线性回归模型，其参数可以通过普通最小二乘法（Ordinary Least Squares, OLS）进行估计，这使得模型的实施变得非常直接和高效 。然而，对这一标准估计方法的深入审视揭示了其内在的局限性，并为提高模型的预测精度指明了方向。  

**OLS的局限性**： 标准做法是直接将OLS应用于原始的RV时间序列。然而，RV序列本身具有一些不符合OLS经典假设的典型化事实，包括：存在尖峰和异常值（spikes/outliers）、条件异方差性（conditional heteroskedasticity）以及非高斯分布（non-Gaussianity）。OLS估计量对异常值高度敏感，一个极端的数据点就可能严重扭曲参数估计结果。此外，在存在条件异方差或非高斯误差的情况下，OLS虽然仍是无偏的，但不再是有效的（即方差最小的）估计量。因此，将OLS直接应用于原始RV的组合被认为是“远非理想”的（far from ideal），为模型的改进留下了显著空间 。  

**提高预测精度的途径**： 学术研究已经清晰地指出了两条简单而有效的改进路径，这标志着HAR模型研究从模型设定阶段走向了更为成熟的稳健估计阶段：

1.  **采用替代估计方法**：
    
    -   **加权最小二乘法（Weighted Least Squares, WLS）**：WLS通过为每个观测值赋予不同的权重来解决异方差性问题。在HAR模型的应用中，一种常见的做法是使用RV的某种函数（如RV的倒数）作为权重，从而降低高波动（通常也是异常值所在）时期的观测值在参数估计中的影响力。实证研究表明，WLS-HAR方案相比于OLS-HAR，能够将QLIKE损失函数值降低高达24% 。  
        
    -   **岭回归（Ridge Regression, RR）**：RR是一种正则化方法，通过在损失函数中加入一个惩罚项来处理多重共线性问题，并能有效收缩系数，降低模型方差。在存在异常值时，RR也能提供比OLS更稳健的估计。
        
    -   这些替代估计方法，尤其是在预测较长的时间视界时，其优势尤为明显 。  
        
2.  **对数据进行变换**：
    
    -   在进行OLS估计之前，对RV序列进行非线性变换是另一种有效抑制异常值影响和稳定方差的方法。
        
    -   **对数变换（Logarithmic Transformation）**：将模型中的RV替换为其自然对数（即log-HAR模型），是目前最常用且效果最好的变换方法。由于对数函数可以显著压缩极端大值，因此它能有效减轻RV尖峰对OLS估计的冲击。
        
    -   **平方根变换（Square Root Transformation）**：平方根变换同样具有稳定方差的效果，但实证研究普遍发现其效果略逊于对数变换 。  
        
    -   研究表明，基于变换后RV的HAR模型（即使仍使用OLS估计）相比于基于原始RV的标准HAR模型，在预测损失度量上能实现显著的降低 。  
        

这种从关注“模型结构是否正确”到关注“在给定数据特性下如何最好地估计该结构”的演变，体现了该研究领域的深化。它表明，在不增加模型复杂性的前提下，仅通过对估计方法的精细化调整，就能获得巨大的性能提升。

## 3\. HAR模型的关键扩展

经典的HAR-RV模型以其简洁性和强大的预测能力成为了波动率建模的基准。然而，其线性、纯自回归的结构无法捕捉金融市场中所有已知的典型化事实。因此，研究文献沿着“分而治之”（divide and conquer）的范式，在HAR的核心框架上进行了一系列重要的扩展，系统性地分离并建模了诸如跳跃、杠杆效应等特定的市场现象。这种模块化的研究路径使得HAR模型从一个单一的模型演变为一个灵活、可扩展的建模框架平台。

### 3.1 HAR-CJ模型：分解波动率以隔离跳跃的影响

**理论基础**： 金融资产价格的变动路径并非总是平滑连续的。在重大新闻事件（如宏观经济数据发布、公司重大公告、地缘政治冲击等）发生时，价格常会出现瞬间的大幅跳动，即“跳跃”（Jumps）。总的已实现波动率可以被分解为两个部分：由正常交易活动驱动的、平滑变动的“连续路径方差”（Continuous Path Variation），以及由这些突发事件驱动的“不连续跳跃方差”（Discontinuous Jump Variation） 。这两个成分对未来波动率的动态影响和持续性存在显著差异，将它们分开建模有望提高预测的精度。  

**方法论**： 为了在实证中分离这两个成分，研究者们开发了对跳跃不敏感的（jump-robust）波动率估计量。其中最著名的是由Barndorff-Nielsen和Shephard提出的“双幂次变差”（Bipower Variation, BPV）。BPV通过计算相邻高频回报率绝对值的乘积之和来估计连续路径方差。然后，总RV与BPV之间的差值，在超过某一显著性水平时，就被识别为跳跃方差 。  
```math
J_t=\max(RV_t−BPV_t​,0) \\

C_t​=RV_t​−J_t​=BPV_t​
```
**模型构建**： HAR-CJ（Continuous and Jumps）模型及其变体（如HAR-J）通过在标准HAR模型的回归方程中加入过去跳跃成分的滞后项来进行扩展。这样，模型就可以分别评估连续波动和跳跃波动对未来总波动率的预测能力。Andersen等人（2007）提出的模型形式通常如下 ：  
```math
RV_{t+1}=β_0+β_cC_t^{(d)}+β_wC_t^{(w)}+β_mC_t^{(m)}+β_jJ_t^{(d)}+β_{jw}J_t^{(w)}+β_{jm}J_t^{(m)}+ϵ_{t+1}
```
其中，$C_t$ 和 $J_t$ 分别代表在不同时间视界（日、周、月）下的连续波动成分和跳跃成分。实证研究发现，跳跃成分对未来波动率具有显著的正向预测能力，但其影响通常是短暂的。而连续路径成分则表现出更强的持续性。将跳跃纳入模型，尤其是在市场动荡时期，能够显著改善模型的拟合度和样本外预测性能，对于风险管理具有重要意义 。  

### 3.2 LHAR模型：捕捉杠杆效应带来的非对称波动

**理论基础**： “杠杆效应”是金融市场中一个根深蒂固的非对称现象，最早由Black（1976）提出。它指的是资产价格的负向回报（坏消息）比同等大小的正向回报（好消息）更能引起未来波动率的上升 。这种现象的经济学解释有两种主流观点：一是财务杠杆理论，即股价下跌会提高公司的债务股本比，增加股权持有者的风险，从而导致股价波动性上升；二是波动率反馈理论，即预期的波动率上升会增加风险溢价，导致股价下跌。  

**方法论**： 为了在HAR框架中捕捉这种非对称性，研究者们提出了两种主要方法：

1.  **已实现半方差（Realized Semivariances）**：将日内高频回报率区分为正回报和负回报，然后分别加总它们的平方，得到“上行已实现半方差”（RSV+）和“下行已实现半方差”（RSV−）。通过在模型中同时引入这两个变量，可以检验负向回报驱动的波动率是否比正向回报驱动的波动率具有更强的预测能力 。  
    
2.  **直接引入负向回报**：在回归方程中直接加入过去负向回报的滞后项作为额外的解释变量 。  
    

**模型构建**： LHAR（Leverage HAR）模型将代表杠杆效应的变量加入到HAR模型中。一个典型的LHAR模型可能会使用已实现半方差来代替总RV ：  
```math
\widehat{RV}_{t+1}=β_0+β_d^+RSV_t^{+(d)}+β_d^−RSV_t^{−(d)}+β_w^−RSV_t^{−(w)}+β_m^−RSV_t^{−(m)}+ϵ_{t+1}
```
研究发现，下行半方差（RSV−）的系数通常显著大于上行半方差（RSV+）的系数，证实了杠杆效应的存在。更有趣的是，研究进一步将杠杆效应分解为连续部分和跳跃部分，发现由连续价格路径产生的杠杆效应具有高度的持续性，其影响可以持续一周左右；而由跳跃产生的杠杆效应则非常短暂，其影响通常在一天之内就会消失 。这表明，市场对常规的负面消息和突发的极端负面消息的反应机制是不同的。包含杠杆效应的LHAR模型在预测精度上通常显著优于对称的HAR模型 。  

### 3.3 HAR-X框架：引入外生变量以增强预测能力

**理论基础**： 标准的HAR模型及其上述扩展本质上都是纯粹的自回归时间序列模型，它们仅利用波动率自身的历史信息进行预测。这种方法回答了“未来会发生什么？”的问题，但没有解释“为什么会发生？”。HAR-X（HAR with eXogenous variables）框架通过在模型中引入外部解释变量，将HAR模型从一个纯粹的预测工具转变为一个更具结构性和解释性的经济模型 。其基本思想是，资产的波动率不仅受其自身历史动态的影响，还受到更广泛的宏观经济、市场情绪或其他金融变量的驱动。  

**外生变量的例子**： HAR-X框架的灵活性使其能够容纳多种类型的外生变量：

-   **市场层面的变量**：受资本资产定价模型（CAPM）等理论启发，可以引入更广泛的市场指数的波动率或协方差，以捕捉系统性风险的影响 。  
    
-   **宏观经济变量**：如通货膨胀、GDP增长率、利率等。由于这些变量通常是低频数据（月度或季度），将它们与高频的RV结合需要使用混合数据抽样（Mixed Data Sampling, MIDAS）等特殊计量技术 。  
    
-   **情绪与政策不确定性指标**：投资者情绪指数、基于新闻文本分析构建的经济政策不确定性（EPU）指数、贸易紧张局势指标等，这些变量被证明对市场波动具有显著的预测能力 。  
    
-   **其他金融变量**：芝加哥期权交易所波动率指数（VIX），通常被称为“恐慌指数”，是市场对未来波动预期的直接度量，将其作为预测因子可以显著提升模型性能 。此外，交易量、其他资产类别（如大宗商品）的波动率等也常被用作外生变量 。  
    

**模型构建**： HAR-X模型的构建非常直接，只需在标准HAR模型的回归方程中加入外生变量 $X_t$ 的滞后项即可。例如，一个包含单一外生变量的HAR-X模型可以表示为 ：  
```math
RV_{t+1}^{(d)}=β_0​+β_d​RV_t^{(d)}+β_w​RV_t^{(w)}+β_m​RV_t^{(m)}+\gamma X_t​+ϵ_{t+1}
```
通过检验系数 $\gamma$ 的显著性，研究者可以评估特定经济因素对资产风险的驱动作用，从而将HAR模型从一个“黑箱”式的预测算法，提升为一个能够检验经济学假说的计量工具。

### 3.4 其他值得注意的变体

HAR框架的灵活性催生了众多其他变体，以下简要介绍其中几个重要的模型：

-   **HARQ模型**：该模型由Bollerslev, Patton, and Quaedvlieg（2016）提出，旨在直接处理RV作为真实积分方差的度量误差问题。HARQ模型通过引入“已实现四分差”（Realized Quarticity, RQ）作为度量误差方差的代理变量，并允许HAR模型的参数随度量误差的大小动态变化。结果发现，当度量误差较大时，模型会降低对当前RV的依赖，而在市场平稳、度量误差较小时，模型会表现出更强的持续性。HARQ模型被认为是当前波动率预测领域的“最先进”（state-of-the-art）模型之一 。  
    
-   **HARST模型**：该模型将HAR结构与平滑转换自回归（Smooth Transition Autoregressive, STAR）模型相结合，允许模型参数根据某个转换变量（如过去的收益率）的值在不同“机制”（regime）之间平滑地转换。这使得HARST模型能够同时捕捉长记忆性、非线性以及状态转换等复杂的动态特征，如在不同市场环境下杠杆效应的强度变化 。  
    
-   **多变量HAR模型（Multivariate HAR）**：将单变量的HAR模型扩展到多维向量框架，用于同时对多个资产的已实现协方差矩阵进行建模和预测。这对于投资组合优化和系统性风险分析至关重要。多变量HAR模型不仅可以预测各资产自身的波动率，还能捕捉它们之间的波动率传导（spillover）效应 。  
    

为了清晰地展示这些模型的演进脉络和核心特征，下表对主要的HAR模型变体进行了系统性的梳理。

**表1：主要HAR模型变体分类汇总**

| 模型名称 | 代表性数学公式（简化形式） | 核心特征/目的 | 关键参考文献 |
| --- | --- | --- | --- |
| **HAR-RV** | $\widehat{RV}_{t+1} = f(RV_t^{(d)}, RV_t^{(w)}, RV_t^{(m)})$ | 使用日、周、月三尺度波动率近似长记忆性，是所有模型的基础。 | Corsi (2009) |
| **HAR-CJ** | $\widehat{RV}_{t+1} = f(C_t, J_t)$ | 将总波动率分解为连续路径和不连续跳跃部分，分别建模其影响。 | Andersen, Bollerslev, & Diebold (2007) |
| **LHAR** | $\widehat{RV}_{t+1} = f(RSV_t^+, RSV_t^-)$ | 引入已实现半方差或负向回报，捕捉杠杆效应带来的非对称性。 | Corsi & Renò (2012) |
| **HAR-X** | $\widehat{RV}_{t+1} = f(RV_t, X_t)$ | 在模型中加入外生变量（如VIX、EPU），增强模型的解释和预测能力。 |Corsi, Pirino, & Renò (2010) |
| **HARQ** | $\widehat{RV}_{t+1} = f(RV_t, RQ_t)$ | 显式地对已实现波动率的度量误差进行建模，提高参数估计的稳健性。 | Bollerslev, Patton, & Quaedvlieg (2016) |
| **HARST** | $\widehat{RV}_{t+1} = f(RV_t, S_t)$ | 结合平滑转换模型，允许模型参数随市场状态（由转换变量St​决定）变化。 |McAleer & Medeiros (2008) |
| **MV-HAR** | $\text{vech}(\hat{\Sigma}_{t+1}) = f(\text{vech}(\Sigma_t))$ | 将模型扩展至多维，用于预测协方差矩阵和分析波动率溢出效应。 |Chiriac & Voev (2011) |

 

*注：表中的数学公式为简化示意，旨在突出各模型的核心思想。* $f(\cdot)$ *代表线性函数，* $C_t$ *和* $J_t$ *为连续和跳跃成分，* $RSV_t^{\pm}$ *为上下行半方差，* $X_t$ *为外生变量，* $RQ_t$ *为已实现四分差，* $S_t$ *为转换变量，* $\Sigma_t$ *为协方差矩阵。*

## 4\. 在不同资产类别中的实证应用

HAR模型框架的强大之处不仅在于其理论的优雅和结构的多样性，更在于其在各类金融市场中都展现出了卓越的实证表现。该模型在股票、外汇和大宗商品等性质迥异的资产类别中的普遍成功，有力地表明其所依据的异质市场假说（HMH）可能并非特定市场的偶然现象，而是现代金融市场运作的一个普遍性原则。尽管这些市场的微观结构、参与者构成和基本面驱动因素大相径庭——股票由公司业绩和经济增长驱动，外汇由利率差异和资本流动驱动，而大宗商品则受供需冲击和自然因素影响——但一个统一的、基于交易者行为时间视界差异的简单模型结构却能在其中普适地取得成功。这暗示着，无论市场交易的是何种标的，由不同投资视界的参与者共同作用而形成的“波动率瀑布”结构，是信息在市场中被处理并最终体现为价格波动的一个根本性机制。

### 4.1 股票市场波动率预测

股票市场是HAR模型应用最为广泛和深入的领域。大量的研究文献利用HAR及其变体模型对主要股票指数（如标准普尔500指数）以及个股的波动率进行了预测 。实证结果一致表明，相比于传统的GARCH类模型，基于高频数据的HAR模型能够提供显著更优的样本外预测性能 。  

在股票市场中，HAR模型的应用主要体现在以下几个方面：

-   **单变量预测**：最直接的应用是预测单个股票或股票指数的未来日度波动率。研究发现，即使是基础的HAR-RV模型，其样本内和样本外的 $R^2$ 也相当可观，通常样本内 $R^2$ 可达到50%至80%，样本外 $R^2$ 也能达到20%至75%，显示出强大的解释和预测能力 。  
    
-   **多变量分析**：多变量HAR模型被广泛用于研究股票市场内部的波动率传导机制。通过构建一个包含多个股票或行业指数的向量自回归系统，研究者可以量化不同资产之间的波动率溢出效应，即一个资产的波动冲击如何影响其他资产的未来波动 。这对于理解市场系统性风险的形成和传播具有重要意义。  
    
-   **扩展模型的应用**：HAR-CJ和LHAR等扩展模型在股票市场中同样表现出色。考虑到股票市场对公司特定新闻和宏观意外事件的敏感性，分离跳跃成分的HAR-CJ模型能更准确地捕捉由突发信息驱动的波动。同时，杠杆效应是股票回报率的一个显著特征，因此LHAR模型在预测股票波动率时通常优于对称的HAR模型。
    

### 4.2 外汇市场波动率动态建模

外汇市场是全球规模最大、流动性最高的金融市场，其7x24小时连续交易的特性使其成为应用高频数据和HAR模型的理想场所 。针对主要货币对（如澳元/美元、欧元/美元等）的实证研究表明，HAR-RV模型能够很好地描述和预测汇率的波动率动态 。  

在外汇市场中，HAR模型的应用特点包括：

-   **高频数据的优势**：由于外汇市场交易的连续性，高频数据能够更完整地捕捉到价格变动的全部信息。研究证实，基于高频已实现波动率的HAR模型，其预测效果远优于基于低频日度数据的模型 。  
    
-   **波动率传导分析**：多变量HAR模型是分析不同货币对之间波动率传导的核心工具。例如，一项研究应用多变量HAR模型分析了欧元/美元、欧元/日元等五个主要欧元交叉盘之间的波动率关系。模型设定一个货币对的日度已实现波动率不仅依赖于其自身的滞后项，还依赖于其他货币对的滞后波动率。研究发现，外汇市场中存在显著的统计上的波动率传导，尤其是在市场不确定性加剧的时期（如金融危机期间），这种传导效应会显著增强 。这表明，主要经济体的风险会通过汇率渠道在全球范围内快速传播。  
    
-   **多尺度效应**：对外汇市场的研究同样证实了HAR模型中多尺度成分的重要性。实证结果显示，日度、周度和月度波动率对未来汇率波动均有显著的正向影响，特别是中长期成分的影响力更为突出 。这与HMH中长期投资者行为决定市场基本风险环境的观点相符。  
    

### 4.3 大宗商品市场的应用

大宗商品市场（包括农产品、能源、金属等）的波动率具有独特的驱动因素，如季节性、天气、地缘政治风险和全球宏观经济周期。尽管如此，HAR模型框架同样被成功地应用于预测大宗商品期货的已实现波动率 。  

在大宗商品市场的应用中，研究呈现出以下发现：

-   **基础模型的稳健性**：针对玉米、大豆、小麦等五种主要农产品的研究发现，即使是简单的HAR-RV模型，其在预测1天至66天未来波动率方面的表现也显著优于标准的自回归（AR）模型 。这再次证明了HAR结构捕捉波动率持续性的普适性。  
    
-   **扩展模型的有限增益**：一个有趣的发现在于，虽然在股票市场中，考虑跳跃和杠杆效应的HAR-CJ和LHAR模型通常能带来预测性能的提升，但在农产品商品市场，这些更复杂的扩展模型在样本外预测中的优势并不明显。研究表明，这些扩展模型并未能产生比简单HAR模型显著更优的预测结果 。这可能意味着，相比于股票市场，大宗商品市场的波动率动态更多地由持续的供需基本面驱动，而非由非对称的杠杆效应或频繁的跳跃主导。  
    
-   **跨市场信息溢出**：HAR-X框架也被用于分析大宗商品市场与其他市场之间的联动。例如，有研究将19种大宗商品期货的波动率信息作为外生变量，纳入预测美国股市波动率的HAR-X模型中。结果发现，来自商品市场的信息，特别是通过模型收缩方法（如Lasso）整合后，能够有效提高对股市波动率的预测准确性，尤其是在高波动时期 。这揭示了不同资产类别之间风险的相互关联和传导。  
    

## 5\. 在金融风险管理中的应用

波动率预测的最终价值体现在其对金融实践的指导作用上，其中最核心的应用领域便是金融风险管理。精确的波动率预测是量化和控制市场风险的前提。HAR模型通过利用高频数据提供更准确、更具时效性的波动率预测，从而极大地提升了现代风险度量工具（如风险价值VaR和预期亏损ES）的性能。将HAR模型整合到风险管理流程中，代表了风险计量方法论的一次重要演进：从依赖静态或反应迟缓的指标，转向能够反映市场日内微观结构变化的动态风险度量。传统的VaR计算方法，如历史模拟法或使用简单移动平均的参数法，对市场状况变化的反应滞后 。基于GARCH模型的VaR虽然引入了动态性，但其信息来源仍局限于日度数据。而基于HAR模型的VaR，通过其输入变量——已实现波动率，将一天内成千上万次的价格变动信息都浓缩到了风险度量中 。这意味着风险评估不再仅仅基于昨日收盘价到今日收盘价的变化，而是基于全天完整的价格路径。这使得风险度量对日内波动率的突然飙升更为敏感，从而能提供更及时、更准确的风险预警，实现了从宏观风险评估到微观市场动态的连接。  

### 5.1 将HAR预测整合到风险价值（VaR）计算中

**风险价值（VaR）的定义**： 风险价值（VaR）是目前金融行业应用最广泛的市场风险度量标准。一个投资组合在给定的置信水平（如95%或99%）和持有期（如1天）下的VaR，是指在该持有期内，该组合预期发生的最大损失值 。从统计学上讲，VaR是投资组合未来回报率分布的某个左尾分位数。例如，99%置信水平下的一日VaR为100万美元，意味着在未来一天内，该组合的损失有99%的概率不会超过100万美元。  

**基于波动率预测的VaR计算方法**： 参数法是计算VaR的常用方法之一，其核心是假设资产回报率服从某一特定的概率分布（如正态分布或学生t分布），然后通过预测该分布的参数来计算分位数。最关键的参数就是条件波动率（即条件标准差）。使用波动率预测来计算一日VaR的标准方法论如下 ：  
```math
VaR_{t+1}(α)=\hat σ_{t+1}×F^{−1}(α)
```
其中：

-   $VaR_{t+1}(\alpha)$ 是在 $t$ 时刻预测的 $t+1$ 日的VaR值，α是置信水平（如99%时，α为0.01）。
    
-   $\hat{\sigma}_{t+1}$ 是对 $t+1$ 日条件波动率（标准差）的预测值。
    
-   $F^{-1}(\alpha)$ 是所假设的标准化回报率分布（均值为0，方差为1）的 $\alpha$ 分位数。例如，在正态分布假设下，99%置信水平的分位数约为-2.33。
    

**HAR模型的作用**： 在这一框架中，HAR模型的关键作用就是提供高质量的波动率预测值 $\hat{\sigma}_{t+1}$ 。具体步骤是：

1.  使用HAR模型（如HAR-RV或其扩展形式）对下一日的已实现方差 $\hat{RV}_{t+1}$ 进行预测。
    
2.  将预测的已实现方差开方，得到条件波动率的预测值 $\hat{\sigma} _ {t+1}=\sqrt{\hat{RV} _ {t+1}}$  。
    
3.  将 $\hat{\sigma}_{t+1}$ 代入上述VaR计算公式。
    

通过这种方式，HAR模型能够将高频数据中蕴含的丰富信息有效地传递到VaR的计算中，使得风险度量更加精确和动态，能够及时反映市场风险状况的变化 。  

### 5.2 使用预期亏损（ES）推进风险评估

**预期亏损（ES）的定义**： 尽管VaR应用广泛，但它存在一个重要的理论缺陷：VaR只告诉我们“在正常情况下最多会亏损多少”，但没有提供任何关于“一旦发生极端损失（即损失超过VaR），平均会亏损多少”的信息。它忽略了尾部风险的严重程度 。为了弥补这一不足，金融监管机构和风险管理实践中越来越多地采用预期亏损（Expected Shortfall, ES），又称条件风险价值（Conditional VaR, CVaR） 。ES被定义为，在损失超过VaR值的条件下，该损失的条件期望值 。ES是一个“一致性风险度量”（coherent risk measure），比VaR对损失分布的尾部形状更敏感，能更好地捕捉极端风险 。  

**HAR模型在ES计算中的应用**： ES的计算同样高度依赖于对整个回报率分布的准确刻画，而这其中波动率的预测是核心环节。与VaR类似，计算ES也需要一个高质量的波动率预测值  $\hat{\sigma}_{t+1}$ 来校准回报率分布的尺度。一旦使用HAR模型得到了 $\hat{\sigma}_{t+1}$，就可以通过对所假设的分布的尾部进行积分来计算ES。例如，在正态分布假设下，ES的计算公式为：
```math
ES_{t+1}(α)=\hatσ_{t+1}×\frac{α}{\phi(F^{−1}(α))}
```
其中 $\phi(\cdot)$ 是标准正态分布的概率密度函数。

鉴于巴塞尔银行监管委员会（Basel Committee on Banking Supervision）已正式建议在其市场风险监管框架中用ES取代VaR，开发基于HAR模型等先进波动率预测技术的ES计算方法，已成为金融机构风险管理和合规工作的重中之重 。  

### 5.3 HAR风险模型的性能评估

一个风险模型的优劣最终需要通过“返回检验”（Backtesting）来评估。返回检验的核心思想是将模型过去预测的风险值（VaR或ES）与实际发生的投资组合回报进行比较，看预测的失败率（即实际损失超过VaR的频率）是否与预设的置信水平相符。

针对基于HAR模型的风险模型，实证研究取得了一些积极的成果。例如，有研究表明，基于HAR模型的VaR预测能够提供令人满意的风险阈值 。此外，研究还发现，在HAR框架内采用更灵活的、由数据驱动的滞后结构（如使用Lasso方法选择滞后项），相比于使用固定的（1, 5, 22）结构，能够在预测波动率和VaR方面都取得更优的表现 。这表明，通过对HAR模型进行精细化调整，可以进一步提升其在实际风险管理应用中的价值。  

## 6\. 比较分析与批判性评估

### 6.1 HAR vs. GARCH：正面比较

HAR和GARCH代表了波动率建模领域的两大主流范式。尽管它们都旨在捕捉波动率的动态特征，但其在模型哲学、数据要求、估计方法和实证表现上存在根本性的差异。对这两大模型家族进行系统性的比较，有助于深刻理解现代波动率建模的演进路径。

这场比较的最终结论在很大程度上可以归结为“数据的胜利优于模型的复杂性”。表面上看，GARCH模型在数学上更为复杂，它涉及非线性结构和准最大似然估计。相比之下，HAR模型是一个简单的线性回归。然而，在样本外预测的竞技场上，更简单的HAR模型却能持续胜出 。这其中的关键差异在于输入数据。GARCH模型每天仅使用一个数据点（日度回报率）来推断潜在的波动率，而HAR模型使用的已实现波动率（RV）则可能融合了当天数千个日内价格点的信息。这表明，从高频数据中获得的信息增量是如此巨大，以至于它允许一个结构更简单的模型击败一个在信息更贫乏的数据上运行的更复杂的模型。HAR模型的成功，与其说是其自身结构的精妙，不如说是它有效利用了一个信息质量远胜一筹的数据集。这突出显示了一个在预测领域至关重要的原则：输入数据的质量，有时比模型本身的复杂程度更为重要。  

下表系统地总结了HAR和GARCH模型家族之间的关键区别。

**表2：比较框架：HAR vs. GARCH模型**

| 特征 | HAR模型家族 | GARCH模型家族 |
| --- | --- | --- |
| **核心哲学** | 对可观测的波动率代理（RV）进行建模，模型结构源于经济学理论（HMH）。 | 对不可观测的潜在波动率进行滤波，是纯粹的统计时间序列模型。 |
| **波动率度量** | 已实现波动率（RV），一个非参数的、基于高频数据的估计量。 | 条件方差，一个通过模型从低频回报率中推断出的参数。 |
| **数据要求** |需要高频日内数据来计算RV 。 | 仅需要低频（通常是日度）的回报率数据。 |
| **估计方法** |通常使用普通最小二乘法（OLS）或其稳健变体（如WLS），计算简单高效 。 | 通常使用准最大似然估计（QML），计算相对复杂。 |
| **长记忆性处理** |通过叠加不同时间尺度的短记忆成分来“近似”长记忆性 。 | 标准GARCH是短记忆的。需要扩展到FIGARCH等复杂模型来处理长记忆性。 |
| **典型预测性能** |在RV可用的情况下，样本外波动率预测性能普遍优于GARCH模型 。 |在预测RV方面，性能通常不及HAR模型 。 |
| **主要优势** |预测精度高、模型简洁、参数具有清晰的经济学解释 。 | 对数据要求低，理论成熟，能够直接从日度回报率建模。 |
| **主要劣势** |依赖高频数据的可得性和质量，对微观结构噪声敏感 。 |无法利用日内信息，对RV的预测能力有限，平方回报率是波动率的嘈杂代理 。 |

 

### 6.2 HAR框架的优势

HAR模型之所以能在短时间内成为波动率预测文献中的“主力模型”（workhorse）和黄金标准，得益于其多方面的显著优势：

-   **简洁性与易处理性**：HAR模型的核心是一个线性回归方程，可以使用最基础的OLS方法进行估计。这使得它在计算上非常高效，易于实现和部署，即使是处理大规模数据集也毫无压力 。这种简洁性与GARCH或随机波动率模型所需的复杂数值优化过程形成了鲜明对比。  
    
-   **清晰的经济学直觉**：与许多纯粹由数据驱动的统计模型不同，HAR模型的结构直接源于一个经济上合乎情理的理论——异质市场假说。其日、周、月三个回归因子的设定，使得模型的参数可以直接被解释为不同投资视界的交易者群体对未来波动率的影响力 。这种内在的可解释性大大增强了模型的吸引力。  
    
-   **卓越的预测能力**：大量的跨市场、跨资产类别的实证研究一致证明，HAR模型及其变体在样本外波动率预测方面表现出持续的、强大的性能。它已经成为衡量任何新提出的波动率预测模型性能的必要基准 。  
    

### 6.3 局限性与未来研究方向

尽管HAR模型取得了巨大成功，但它并非完美无缺。对其局限性的认识，也为未来的研究指明了方向。

-   **估计问题**：如前所述，标准的OLS估计在面对原始RV序列的异常值和异方差性时是次优的。尽管通过数据变换（如对数变换）和使用稳健估计方法（如WLS）可以大大缓解这一问题，但这仍然是从业者在应用模型时必须优先考虑的关键实践细节 。  
    
-   **固定的滞后结构**：经典的（1, 5, 22）滞后结构虽然有其经济学上的合理性，但这种“一刀切”的设定对于所有市场和所有时期都未必是最优的。一些研究利用Lasso等变量选择技术，探索了由数据驱动的、更灵活的滞后结构。结果发现，虽然固定结构在很多时候表现稳健，难以被轻易击败，但在某些情况下，灵活的滞后结构确实能够提供更好的预测性能 。这表明最优的波动率“记忆”结构可能是时变的。  
    
-   **对拟合方案的敏感性**：HAR模型的预测性能被发现对其估计时采用的“拟合方案”（fitting scheme）高度敏感，特别是滚动窗口的大小和模型参数的重新估计频率。研究表明，即使将重新估计的频率从每天一次降低到每两天或每五天一次，模型的预测性能也会出现显著恶化 。这要求在实践中必须采用高频率的参数更新，以确保模型能够及时适应市场环境的变化。  
    

HAR模型的简洁性在带来诸多优势的同时，也构成了其性能的“天花板”。作为一个线性模型，它在捕捉市场中复杂的非线性动态和机制转换方面能力有限。正是这一局限性，正在推动波动率预测研究的前沿向混合模型（Hybrid Models）发展。当前的研究趋势是将HAR模型强大的基准性能与其无法捕捉的非线性部分分离开来。例如，先用HAR模型预测波动率的线性部分，然后用支持向量回归（SVR）或长短期记忆网络（LSTM）等机器学习模型来预测HAR模型的残差（即非线性部分） 。虽然有研究指出，一个经过精心调优的HAR模型在某些情况下仍然可以胜过复杂的机器学习模型 ，但学术界的共识正逐渐形成：未来的突破很可能来自于将HAR框架的经济直觉和简洁性与机器学习强大的非线性模式识别能力相结合。这种混合方法旨在集两家之长，在保持模型可解释性的同时，进一步提升预测的精度和稳健性 。  

## 7\. 结论与对从业者的建议

### 7.1 研究发现总结：作为现代波动率预测主力模型的HAR

本报告对异质自回归（HAR）模型进行了全面而深入的评述。综合分析表明，自Corsi（2009）提出以来，HAR模型凭借其简洁的结构、清晰的经济学直觉和持续卓越的预测性能，已经无可争议地确立了其在现代波动率预测领域的“主力模型”和核心基准的地位 。  

HAR模型的成功可以归结为两大支柱的完美结合。第一，它在理论上根植于异质市场假说（HMH），通过巧妙地叠加日、周、月三个不同时间尺度的波动率成分，以一个极其简洁的线性结构，成功地近似了金融波动率复杂的长记忆性特征。第二，它在数据上充分利用了高频金融数据带来的范式革命，以信息含量极为丰富的已实现波动率（RV）作为建模对象，从根本上提升了波动率度量的精度，从而为简单的模型战胜复杂但基于嘈杂数据的模型创造了条件。从经典的HAR-RV模型，到捕捉跳跃（HAR-CJ）、杠杆效应（LHAR）和外部信息（HAR-X）的各种扩展，HAR已经从一个单一模型演变为一个灵活、强大且可扩展的建模框架，在股票、外汇、大宗商品等各类资产的波动率预测和风险管理应用中都取得了巨大的成功。

### 7.2 模型选择、估计与实施的实践指南

基于对现有文献的系统性回顾，本报告为金融从业者（如量化分析师、风险管理师、投资组合经理）在实际工作中应用HAR模型提供以下具体、可操作的建议：

1.  **避免使用标准配置**：从业者应避免直接使用“普通最小二乘法（OLS）+ 原始已实现方差（raw RV）”这一最基础的组合。由于原始RV序列普遍存在尖峰、异常值和非高斯性，标准的OLS估计结果是次优的 。  
    
2.  **优先选择对数变换和稳健估计**：一个更优越的起点是，首先对RV序列进行对数变换（即构建log-HAR模型），这能有效压缩极端值，使数据更接近正态分布。在此基础上，推荐使用加权最小二乘法（WLS）代替OLS进行参数估计，以进一步降低异常值和异方差性带来的负面影响。这一组合（log-HAR + WLS）被证明能够显著提高预测的准确性 。  
    
3.  **根据市场特征选择模型扩展**：
    
    -   如果所分析的资产对突发新闻高度敏感，或在市场危机期间进行建模，那么考虑使用能够分离跳跃成分的**HAR-CJ**模型将是明智的选择。
        
    -   如果资产（尤其是股票）表现出明显的杠杆效应（即负回报导致更高的波动率），那么应优先选择**LHAR**模型，因为它能捕捉这种重要的非对称性。
        
    -   如果存在明确的、被理论或经验证明能够驱动波动率的外部变量（如VIX指数、经济政策不确定性指数），则应使用**HAR-X**框架将其纳入模型，以期获得更强的预测能力。
        
4.  **高度重视拟合方案**：模型的预测性能对参数的更新频率极为敏感。为了让模型能及时捕捉到市场动态的变化，**采用滚动窗口并进行每日参数重新估计**是至关重要的。忽略这一点，即使模型结构再精巧，其预测能力也会大打折扣 。  
    
5.  **关注数据质量**：HAR模型的基石是高质量的高频数据和准确的RV计算。从业者必须对**市场微观结构噪声**（如买卖价差、价格离散性等）保持警惕。在计算RV时，选择合适的采样频率（如5分钟）是一个关键的权衡：频率过高会引入噪声，频率过低则会损失信息。在实践中，应根据资产的流动性和市场特性，审慎选择最优采样频率 。  
    

### 7.3 波动率预测的未来展望

展望未来，虽然HAR模型作为基准的地位依然稳固，但波动率预测研究的前沿正在向更广阔的领域拓展。纯粹的HAR模型，因其线性和固定结构的内在属性，可能已接近其性能的上限。未来的突破将主要来自于两个方向的融合：

首先，是**模型结构的灵活性**。放弃固定的（1, 5, 22）滞后结构，转而采用Lasso、弹性网等机器学习中的变量选择和模型平均技术，来动态地、由数据驱动地确定最优的波动率记忆结构，是一个充满潜力的研究方向。

其次，也是更重要的方向，是**混合建模**。将HAR模型强大的、基于经济学直觉的线性框架，与深度学习（如LSTM网络）等现代机器学习技术强大的非线性模式识别能力相结合，是当前研究的热点。这种混合模型旨在利用HAR捕捉波动率的主要持续性特征，同时利用机器学习模型来拟合HAR无法解释的复杂非线性残差。这种“经济学+计算机科学”的跨学科融合，有望在保持模型一定可解释性的同时，将波动率预测的精度推向新的高度，为未来的金融风险管理和量化交易提供更强大的分析工具。
